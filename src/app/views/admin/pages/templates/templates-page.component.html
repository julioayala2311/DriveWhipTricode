<section class="templates-page">
  <header class="page-header">
    <div>
      <h1 class="page-title">Templates</h1>
      <p class="page-subtitle">
        Manage notification templates used across applicants workflows.
      </p>
    </div>
    <div class="header-actions d-flex align-items-center gap-2">
      <button
        type="button"
        class="btn btn-sm btn-ghost d-flex align-items-center gap-1"
        (click)="loadTemplates()"
        [disabled]="loading"
      >
        <i class="feather icon-rotate-cw"></i>
        <span>Refresh</span>
      </button>
      <button
        type="button"
        class="btn btn-sm btn-primary d-flex align-items-center gap-1"
        (click)="openCreateTemplate()"
      >
       
        <span>Add Template</span>
      </button>
    </div>
  </header>

  <div class="grid-card">
    <div class="alert alert-warning py-2 px-3 mb-0" *ngIf="error">
      {{ error }}
    </div>
    <div class="grid-toolbar">
      <div>
        <strong>{{ rowCount }}</strong> templates
        <span class="text-secondary" *ngIf="selectedCount">
          &bull; {{ selectedCount }} selected
        </span>
      </div>
    </div>

    <div class="grid-wrapper">
      <ag-grid-angular
        class="ag-theme-quartz dw-grid-theme templates-grid"
        [rowData]="rowData"
        [columnDefs]="columnDefs"
        [defaultColDef]="defaultColDef"
        [gridOptions]="gridOptions"
        [pagination]="true"
        [paginationPageSize]="pageSize"
        [paginationPageSizeSelector]="pageSizeOptions"
        rowSelection="multiple"
        (gridReady)="onGridReady($event)"
        (firstDataRendered)="onFirstDataRendered($event)"
        (selectionChanged)="onSelectionChanged($event)"
        (paginationChanged)="onPaginationChanged($event)"
        (cellClicked)="onCellClicked($event)"
      ></ag-grid-angular>
    </div>

    <div class="grid-footer">
      <div class="text-secondary small">
        Page {{ displayPageIndex }} of {{ displayTotalPages }}
      </div>
      <div class="d-flex gap-2">
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          (click)="goToPreviousPage()"
          [disabled]="currentPage === 0"
        >
          <i class="feather icon-chevron-left"></i>
        </button>
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          (click)="goToNextPage()"
          [disabled]="displayTotalPages <= 1 || currentPage >= totalPages - 1"
        >
          <i class="feather icon-chevron-right"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="modal-backdrop" *ngIf="showCreateModal"></div>
  <div class="modal-centered" *ngIf="showCreateModal">
    <div class="modal-card">
      <div class="modal-header d-flex align-items-center justify-content-between">
        <h5 class="mb-0">Add Template</h5>
        <button type="button" class="btn btn-sm btn-ghost" (click)="closeCreateModal()" aria-label="Close">
          <i class="feather icon-x"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <label class="form-label small">Template code</label>
          <input class="form-control form-control-sm" [(ngModel)]="newTemplate.code" placeholder="welcome_email" />
        </div>
        <div class="mb-3">
          <label class="form-label small">Template name</label>
          <input class="form-control form-control-sm" [(ngModel)]="newTemplate.name" placeholder="Welcome Email" />
        </div>
        <div class="row g-2">
          <div class="col-12 col-md-6">
            <label class="form-label small">Format</label>
            <input class="form-control form-control-sm" [(ngModel)]="newTemplate.format" placeholder="Email / SMS" />
          </div>
          <div class="col-12 col-md-6">
            <label class="form-label small">Message type</label>
            <select class="form-select form-select-sm" [(ngModel)]="newTemplate.messageType">
              <option value="Email">Email</option>
              <option value="SMS">SMS</option>
              <option value="Push">Push</option>
            </select>
          </div>
        </div>
        <div class="mt-3">
          <label class="form-label small">Last edited by</label>
          <input
            class="form-control form-control-sm"
            [(ngModel)]="newTemplate.lastEditedBy"
            placeholder="you@drivewhip.com"
          />
        </div>
      </div>
      <div class="modal-footer d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-outline-secondary btn-sm" (click)="closeCreateModal()">
          Cancel
        </button>
        <button type="button" class="btn btn-primary btn-sm" (click)="saveTemplate()">
          Save Template
        </button>
      </div>
    </div>
  </div>

  <!-- <div class="manage-link-wrapper mt-3 text-end">
    <a class="manage-link d-inline-flex align-items-center gap-1" routerLink="/configurations/templates">
      <span>Manage templates</span>
      <i class="feather icon-external-link"></i>
    </a>
  </div> -->
</section>
